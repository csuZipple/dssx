<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>克里斯多的神秘商店-商品详情</title>
    <link rel="stylesheet" href="../css/app.css">
    <link rel="stylesheet" href="../css/my-defined.css">
    <link rel="stylesheet" href="../css/old/css/foundation.css">
    <link rel="stylesheet" href="../css/old/css/app.css">
</head>
<body>



<!--响应式设计-->
<!--顶部导航-->
<!--移动端菜单怎么固定导航-->
<div class="page-main">
    <div class="page-top">
        <div class="title-bar"  data-sticky data-options="marginTop:0;" data-responsive-toggle="responsive-menu" data-hide-for="medium">
            <button class="menu-icon" type="button" data-toggle="offCanvas"></button>
            <div class="title-bar-title">Menu</div>
        </div>
        <!--sticky 固定导航条-->
        <div class="top-bar show-for-medium" data-sticky data-options="marginTop:0;" style="width:100%;z-index: 998" id="responsive-menu">
            <div class="top-bar-left">
                <ul class="menu dropdown"  data-dropdown-menu>
                    <li class="menu-text"><a href="javascript:go('main.html')" title="返回首页" style="display: inline;color: #000;">Christo</a></li>
                    <li class="isLogin"><a href="javascript:go('login.html')">登录</a></li>
                    <li class="isRegister"><a href="javascript:go('register.html')">注册</a></li>
                    <li id="li-items-type"><a href="#!"><button class="divide-type" id="items-type" data-toggle="offCanvasTop">分类查询</button></a></li>

                </ul>
            </div>
            <div class="top-bar-right">
                <ul class="menu dropdown" data-dropdown-menu>
                    <li class="show-for-medium isUserAvatar"><img class="avatar" src="../images/avatar/default-avatar.png" alt="avatar"></li>
                    <li class="show-for-medium isUserName"><a class="user-name" href="">zipple</a></li>
                    <li class="isShowUser"> <!--头像及个人中心先判断用户是否登录 未登录则不显示-->
                        <a href="javascript:go('user-zone.html')">个人中心</a>
                        <ul class="menu vertical">
                            <li><a href="javascript:go('user-zone.html','cart')">购物车</a></li>
                            <li><a data-link="favorite" href="javascript:go('user-zone.html','favorite')">我的收藏</a></li>
                            <li><a data-link="history" href="javascript:go('user-zone.html','history')">浏览历史</a></li>
                        </ul>
                    </li>
                    <li class="show-for-medium isLogout"><a href="javascript:logout()">退出登录</a></li>
                </ul>
            </div>
        </div>

        <!--移动端菜单-->
        <div class="off-canvas position-left" id="offCanvas" style="background: #121212;color: #ffffff;z-index: 200;" data-off-canvas>
            <ul class="vertical menu left-menu">
                <!--默认头像-->
                <li style="width: 100%;min-height: 100px;padding-left: 15px;box-sizing: border-box">
                    <img style="width: 80px;height: 80px;object-fit: cover;border-radius: 50%" src="../images/avatar/02.jpg" class="user-avatar" alt="avatar">
                    <p  class="user-name" style="border-bottom: 1px solid #ffffff;padding-left: 5px;">default name</p>
                </li>
                <!--这里为什么会有默认的黄线-->
                <li><a href="javascript:go('login.html')" style="color: #ffffff;"><i class="fi-cloud"></i>&nbsp;登录</a></li>
                <li><a href="javascript:go('register.html')" style="color: #ffffff;"><i class="fi-results-demographics"></i>&nbsp;注册</a></li>
                <li><button class="divide-type" data-toggle="offCanvasTop"><i class="fi-page"></i>&nbsp;  分类查询</button></li>
                <li><a href="javascript:go('user-zone.html')" style="color: #ffffff;"><i class="fi-home"></i>&nbsp;个人中心</a></li>
                <li><a href="javascript:go('user-zone.html','cart')" style="color: #ffffff;"><i class="fi-shopping-cart"></i>&nbsp;购物车</a></li>
                <li><a href="javascript:go('user-zone.html','history')" style="color: #ffffff;"><i class="fi-eye"></i>&nbsp;浏览历史</a></li>
                <li><a href="javascript:go('user-zone.html','favorite')" style="color: #ffffff;"><i class="fi-star"></i>&nbsp;收藏夹</a></li>
                <li><a href="javascript:logout()" style="color: #ffffff;"><i class="fi-unlink"></i>&nbsp;退出</a></li>
            </ul>
        </div>

        <!--分类查询菜单-->
        <div class="off-canvas position-top" id="offCanvasTop" style="background: #121212;color: #ffffff;z-index: 999" data-off-canvas>
            <ul class=" dropdown menu root-category" data-dropdown-menu style="height: 100%;">
             </ul>
        </div>

        <!--右侧固定返回顶部-->
        <div class="back-to-top text-center show-for-medium">
            <a href="javascript:goTop()" title="返回顶部" class="grid-x align-center" style="background: url('../images/icon/top.png') center ; background-size: contain"></a>
        </div>
    </div>
    <div class="page-content grid-x large-10 align-center">

        <div class="small-12 medium-8 grid-x align-center" style="margin-top: 42px;min-height: 480px;">
            <div class="pay-success">
                <div class="pay-success-title">
                    <img src="../images/icon/correct.png" alt="支付成功">您已成功付款！
                    <a href="main.html?uid=?">返回首页&gt;&gt;</a>
                </div>
                <div class="pay-info">
                    <ul class="user-address-info">
                        <li>订单号：<a href="#!" id="orderId" class="red">#201709232350</a></li>
                        <li>
                            收货地址：
                            <span class="address">湖南省长沙市天心区文源街道中南大学铁道学院铁一舍</span>&nbsp; &nbsp;
                            <span class="username">邹博</span>&nbsp; &nbsp;
                            <span class="userphone">18373151083</span>
                        </li>
                        <li>实付款：￥<span class="red total">198.00</span></li>
                    </ul>
                    <ul class="user-address-info">
                        <li class="small-font">
                            <a href="#!">查看我的交易记录</a>
                            <a href="#!">查看已买到商品</a>
                        </li>
                    </ul>

                    <div class="secure-tips">
                        <p><span class="fi-info" style="color:#575dff;font-size: 16px;"></span>&nbsp;&nbsp;<span style="font-weight: bolder;">安全提醒：</span></p>
                        <p class="padding-left">下单后，<span class="red">用QQ给您发送链接办理退款</span>的都是骗子！克里斯多商城不存在系统升级，订单异常等问题，谨防假冒客服电话诈骗！</p>
                    </div>

                    <div class="comments-area">
                        这里是添加评论的区域
                    </div>
                </div>
            </div>
        </div>

        <div class="small-12 medium-8 grid-x align-justify recommend-items ">
            <div class="small-12 random-items-title">
                <i class="fi-results"></i>&nbsp;&nbsp;随便看看
            </div>


        </div>

    </div>

    <!--底部信息-->
    <footer>
        <div class="bottom-info">
            <div>Copyright © 2017 Christo. All Rights Reserved. </div>
            <div>东软教育-地表最强小组</div>
        </div>
    </footer>
</div>

<script src="../bower_components/jquery/dist/jquery.js"></script>
<script src="../bower_components/what-input/dist/what-input.js"></script>
<script src="../bower_components/foundation-sites/dist/js/foundation.js"></script>
<script src="../js/app.js"></script>
<script src="../js/common.js"></script>
<script src="../js/validate.js"></script>
<script src="../js/creator.js"></script>
<script>
   /*
   * 加载第一份订单
   * */
    loadPage();
    function loadPage() {
          var order = getFirstOrder(getUid());//获取最近的一份订单.
        console.log(order);
          $("#orderId").text("#"+order.createdAt.replace("T","").replace(":","").replace("-",""));
          $(".address").text(order.address);
          $(".username").text(order.name);
          $(".userphone").text(order.phone);
        $(".total").text(order.totalPrice)
        loadRandomItems(4)
    }
   /**
    * 获取第一份订单
    * @param uid
    */
    function getFirstOrder(uid) {
       console.log(uid);
        var firstOrder = ajax("order/getAllOrders",{"userId":uid},false);
        var json={};
       console.log(firstOrder);
       if (firstOrder.success){
            $.each(firstOrder.data,function (index, item) {
                if (index==4) {
                    json=item;
                }
            })
        }
        console.log("接收到地址");
        console.log(json);
        return json;
    }

   function loadRandomItems(count) {
       console.log("加载更多..."+count);
       var result = ajax("product/getMore",{"startId":count},false);
       if (result.success){
           $.each(result.data,function (index, item) {
               if (index<4){
                   count++;
                   createRandomItems(".recommend-items",item.id,rootImageUrl+item.imageUrls[0].imageUrl,item.name,item.description)
               }else{
                   return false;
               }
           })
       }
       if (typeof (result.data[0].id) == 'undefined'){
           alert("没有更多数据了!")
       }
   }
   
</script>
</body>
</html>
